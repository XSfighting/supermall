"use strict";(self["webpackChunksupermall"]=self["webpackChunksupermall"]||[]).push([[772],{9707:function(t,e,a){a.d(e,{Z:function(){return l}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tab-control"},t._l(t.titles,(function(e,r){return a("div",{staticClass:"tab-control-item",class:{active:r===t.currentIndex},on:{click:function(e){return t.itemClick(r)}}},[a("span",[t._v(t._s(e))])])})),0)},i=[],s={name:"TabControl",props:{titles:{type:Array,default(){return[]}}},data(){return{currentIndex:0}},methods:{itemClick(t){this.currentIndex=t,this.$emit("tabClick",t)}}},n=s,c=a(1001),o=(0,c.Z)(n,r,i,!1,null,"08bc7f4a",null),l=o.exports},4611:function(t,e,a){a.r(e),a.d(e,{default:function(){return B}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"category"}},[a("nav-bar",{staticClass:"cate-nav"},[a("div",{attrs:{slot:"center"},slot:"center"},[t._v("分类")])]),a("div",{staticClass:"content"},[a("tab-menu",{staticClass:"tab-menu",attrs:{categories:t.categories},on:{selectItem:t.selectItem}}),a("scroll",{staticClass:"scroll-content"},[a("tab-content",{attrs:{categoriesProduct:t.categoriesProduct}}),a("tab-control",{attrs:{titles:["综合","新品","销量"]},on:{tabClick:t.tabClick}}),a("tab-content-detail",{attrs:{categoryDetail:t.showCategoryDetail}})],1)],1)],1)},i=[],s=a(334),n=a(57),c=a(9707),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("scroll",{attrs:{id:"tab-menu"}},[a("div",{staticClass:"menu-list"},t._l(t.categories,(function(e,r){return a("div",{key:r,staticClass:"menu-list-item",class:{active:r===t.currentIndex},on:{click:function(e){return t.itemClick(r)}}},[t._v(" "+t._s(e.title)+" ")])})),0)])},l=[],u={name:"TabMenu",components:{Scroll:n.Z},props:{categories:Array},data(){return{currentIndex:0}},methods:{itemClick(t){this.currentIndex=t,this.$emit("selectItem",t)}}},g=u,d=a(1001),h=(0,d.Z)(g,o,l,!1,null,"e9a9e46c",null),m=h.exports,p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tab-content"},[t.categoriesProduct?a("grid-view",{attrs:{cols:3,lineSpace:15,"v-margin":20}},t._l(t.categoriesProduct,(function(e,r){return a("div",{key:r,staticClass:"content-item"},[a("img",{attrs:{src:e.image,alt:""}}),a("div",[t._v(t._s(e.title))])])})),0):t._e()],1)},y=[],f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"gridView",staticClass:"grid-view"},[t._t("default")],2)},b=[],_={name:"GridView",props:{cols:{type:Number,default:2},hMargin:{type:Number,default:8},vMargin:{type:Number,default:8},itemSpace:{type:Number,default:8},lineSpace:{type:Number,default:8}},mounted(){setTimeout(this._autoLayout,20)},updated(){this._autoLayout()},methods:{_autoLayout(){let t=this.$refs.gridView,e=t.children;t.style.padding=`${this.vMargin}px ${this.hMargin}px`;let a=(t.clientWidth-2*this.hMargin-this.cols*this.itemSpace)/this.cols;for(let r=0;r<e.length;r++){let t=e[r];t.style.width=a+"px",(r+1)%this.cols!==0&&(t.style.marginRight=this.itemSpace+"px"),r>=this.cols&&(t.style.marginTop=this.lineSpace+"px")}}}},v=_,C=(0,d.Z)(v,f,b,!1,null,"947a6bca",null),D=C.exports,x={name:"TabContent",props:{categoriesProduct:{type:Array,default(){return[]}}},data(){return{}},components:{GridView:D}},k=x,I=(0,d.Z)(k,p,y,!1,null,"40102e86",null),w=I.exports,T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.categoryDetail?a("grid-view",{attrs:{lineSpace:15,"v-margin":20}},t._l(t.categoryDetail,(function(t,e){return a("goods-list-item",{key:e,attrs:{goodsItem:t}})})),1):t._e()},S=[],Z=a(1947),$={name:"TabContentDetail",components:{GridView:D,GoodsListItem:Z.Z},props:{categoryDetail:{type:Array,default(){return[]}}},created(){}},M=$,P=(0,d.Z)(M,T,S,!1,null,"71d7d322",null),E=P.exports,N=a(2924);function W(){return(0,N.W)({url:"/category"})}function V(t){return(0,N.W)({url:"/subcategory",params:{maitKey:t}})}function A(t,e){return(0,N.W)({url:"/subcategory/detail",params:{miniWallkey:t,type:e}})}var G={name:"Category",components:{NavBar:s.Z,Scroll:n.Z,TabControl:c.Z,TabMenu:m,TabContent:w,TabContentDetail:E},data(){return{categories:[],currentIndex:0,categoryData:[],categoriesProduct:[],currentType:"pop"}},created(){this._getCategory()},mounted(){},methods:{_getCategory(){W().then((t=>{this.categories=t.data.category.list;for(let e=0;e<this.categories.length;e++)this.categoryData[e]={subcategories:{},categoryDetail:{pop:[],new:[],sell:[]}};this._getSubcategory(0)}))},_getSubcategory(t){this.currentIndex=t;const e=this.categories[t].maitKey;V(e).then((e=>{this.categoriesProduct=e.data.list,this.categoryData[t].subcategories=e.data,this.categoryData={...this.categoryData},this._getCategoryDetail("pop"),this._getCategoryDetail("new"),this._getCategoryDetail("sell"),console.log(this.categoryData[t])}))},_getCategoryDetail(t){const e=this.categories[this.currentIndex].miniWallkey;A(e,t).then((e=>{this.categoryData[this.currentIndex].categoryDetail[t]=e,this.categoryData={...this.categoryData}}))},selectItem(t){this._getSubcategory(t)},tabClick(t){switch(t){case 0:this.currentType="pop";break;case 1:this.currentType="new";break;case 2:this.currentType="sell";break}}},computed:{showCategoryDetail(){return-1===this.currentIndex?[]:(console.log(this.currentType),this.categoryData[this.currentIndex].categoryDetail[this.currentType])}}},L=G,K=(0,d.Z)(L,r,i,!1,null,"7cccc922",null),B=K.exports}}]);
//# sourceMappingURL=772.ce49f1d4.js.map